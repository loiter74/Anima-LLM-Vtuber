# Anima é¡¹ç›®äº®ç‚¹ï¼ˆSTAR æ³•åˆ™ï¼‰

> ğŸ“ **ç”¨äºç®€å†å’Œé¢è¯•** - ä½¿ç”¨ STAR æ³•åˆ™ï¼ˆSituation-Task-Action-Resultï¼‰å±•ç¤ºé¡¹ç›®ä»·å€¼

---

## é¡¹ç›®æ¦‚è¿°

**é¡¹ç›®åç§°**ï¼šAnima - å¯é…ç½®çš„ AI è™šæ‹Ÿä¼´ä¾£/VTuber æ¡†æ¶

**é¡¹ç›®è§’è‰²**ï¼šç‹¬ç«‹å…¨æ ˆå¼€å‘è€…

**é¡¹ç›®å‘¨æœŸ**ï¼š6 ä¸ªæœˆ

**æŠ€æœ¯æ ˆ**ï¼šPython (FastAPI, AsyncIO) + TypeScript (Next.js, React, Socket.IO)

**é¡¹ç›®è§„æ¨¡**ï¼š~8,000 è¡Œä»£ç ï¼ˆåç«¯ 5,000 è¡Œ + å‰ç«¯ 3,000 è¡Œï¼‰

---

## STAR æ³•åˆ™ 1ï¼šæ¶æ„è®¾è®¡

### Situationï¼ˆèƒŒæ™¯ï¼‰

ä½œä¸ºä¸€ä¸ª AI VTuber æ¡†æ¶ï¼Œéœ€è¦æ”¯æŒ**å¤šç§ LLM/ASR/TTS æœåŠ¡å•†**ï¼ˆOpenAIã€æ™ºè°± GLMã€Ollama ç­‰ï¼‰ï¼Œå¹¶ä¸”è¦æ”¯æŒ**åŠ¨æ€åˆ‡æ¢**å’Œ**æ‰©å±•æ–°æœåŠ¡**ã€‚ä¼ ç»Ÿçš„ç¡¬ç¼–ç æ–¹å¼æ— æ³•æ»¡è¶³éœ€æ±‚ã€‚

### Taskï¼ˆä»»åŠ¡ï¼‰

è®¾è®¡ä¸€ä¸ª**å¯æ‰©å±•çš„æ¶æ„**ï¼Œä½¿å¾—æ–°å¢æœåŠ¡å•†æ—¶**ä¸éœ€è¦ä¿®æ”¹æ ¸å¿ƒä»£ç **ï¼Œç¬¦åˆ**å¼€é—­åŸåˆ™**ã€‚

### Actionï¼ˆè¡ŒåŠ¨ï¼‰

1. **è®¾è®¡ Factory + Provider Registry æ¶æ„**
   - åˆ›å»ºæŠ½è±¡æ¥å£ï¼š`ASRInterface`, `TTSInterface`, `LLMInterface`
   - å®ç°å·¥å‚ç±»ï¼š`ASRFactory`, `TTSFactory`, `LLMFactory`
   - è®¾è®¡è£…é¥°å™¨ï¼š`@ProviderRegistry.register_config()`

2. **å®ç°æ’ä»¶åŒ–æ³¨å†Œæœºåˆ¶**
   ```python
   # æ–°å¢æœåŠ¡å•†åªéœ€ 3 æ­¥
   @ProviderRegistry.register_config("llm", "new_provider")
   class NewProviderConfig(LLMBaseConfig):
       type: Literal["new_provider"] = "new_provider"
       api_key: str

   @ProviderRegistry.register_service("llm", "new_provider")
   class NewProviderAgent(LLMInterface):
       @classmethod
       def from_config(cls, config):
           return cls(api_key=config.api_key)
   ```

3. **æ”¯æŒé…ç½®é©±åŠ¨åˆ‡æ¢**
   ```yaml
   # config/config.yaml - ä¸€è¡Œé…ç½®åˆ‡æ¢
   services:
     agent: new_provider  # ä» openai åˆ‡æ¢åˆ° new_provider
   ```

### Resultï¼ˆç»“æœï¼‰

- âœ… æ”¯æŒ **4 å®¶ LLM æœåŠ¡å•†**ï¼ˆOpenAI/GLM/Ollama/Mockï¼‰
- âœ… æ”¯æŒ **4 å®¶ ASR æœåŠ¡å•†**ï¼ˆWhisper/GLM/Faster/Mockï¼‰
- âœ… æ”¯æŒ **4 å®¶ TTS æœåŠ¡å•†**ï¼ˆOpenAI/GLM/Edge/Mockï¼‰
- âœ… **é›¶ä¿®æ”¹æ‰©å±•**ï¼šæ–°å¢æœåŠ¡ä¸éœ€è¦ä¿®æ”¹ä¸€è¡Œæ ¸å¿ƒä»£ç 
- âœ… **é…ç½®é©±åŠ¨**ï¼šé€šè¿‡ YAML é…ç½®æ–‡ä»¶ä¸€é”®åˆ‡æ¢æœåŠ¡å•†

**é¢è¯•è¯æœ¯**ï¼š
> "æˆ‘è®¾è®¡äº†ä¸€ä¸ª**æ’ä»¶åŒ–æ¶æ„**ï¼Œä½¿ç”¨**å·¥å‚æ¨¡å¼**å’Œ**æä¾›è€…æ³¨å†Œæ¨¡å¼**ï¼Œå®ç°äº†**é›¶ä¿®æ”¹æ‰©å±•**ã€‚æ–°å¢ä¸€ä¸ª LLM æœåŠ¡å•†åªéœ€è¦ï¼š
> 1. ç”¨è£…é¥°å™¨æ³¨å†Œé…ç½®ç±»
> 2. ç”¨è£…é¥°å™¨æ³¨å†ŒæœåŠ¡ç±»
> 3. åœ¨é…ç½®æ–‡ä»¶ä¸­åˆ‡æ¢
> æ•´ä¸ªè¿‡ç¨‹**ä¸éœ€è¦ä¿®æ”¹ä¸€è¡Œæ ¸å¿ƒä»£ç **ï¼Œè¿™ä½“ç°äº†**å¼€é—­åŸåˆ™**çš„å®è·µã€‚"

---

## STAR æ³•åˆ™ 2ï¼šäº‹ä»¶é©±åŠ¨æ¶æ„

### Situationï¼ˆèƒŒæ™¯ï¼‰

ç³»ç»Ÿéœ€è¦å¤„ç†**å¤šç§ç±»å‹çš„äº‹ä»¶**ï¼ˆæ–‡æœ¬ã€éŸ³é¢‘ã€è¡¨æƒ…ã€æ§åˆ¶ä¿¡å·ï¼‰ï¼Œå¹¶ä¸”è¦æ”¯æŒ**ä¼˜å…ˆçº§**ï¼ˆæŸäº›äº‹ä»¶ä¼˜å…ˆå¤„ç†ï¼‰å’Œ**å¼‚å¸¸éš”ç¦»**ï¼ˆå•ä¸ªå¤„ç†å™¨å¤±è´¥ä¸å½±å“å…¶ä»–ï¼‰ã€‚

### Taskï¼ˆä»»åŠ¡ï¼‰

è®¾è®¡ä¸€ä¸ª**è§£è€¦çš„äº‹ä»¶ç³»ç»Ÿ**ï¼Œä½¿å¾— Pipelineï¼ˆæ•°æ®å¤„ç†ï¼‰å’Œ Handlersï¼ˆäº‹ä»¶å¤„ç†ï¼‰å®Œå…¨è§£è€¦ã€‚

### Actionï¼ˆè¡ŒåŠ¨ï¼‰

1. **å®ç° EventBus äº‹ä»¶æ€»çº¿**
   ```python
   class EventBus:
       def subscribe(self, event_type, handler, priority):
           """è®¢é˜…äº‹ä»¶"""
           pass

       async def emit(self, event):
           """å‘å¸ƒäº‹ä»¶"""
           # æŒ‰ä¼˜å…ˆçº§æ’åº
           # å¼‚å¸¸éš”ç¦»
           pass
   ```

2. **æ”¯æŒä¼˜å…ˆçº§é˜Ÿåˆ—**
   - `EventPriority.HIGH` - æ–‡æœ¬äº‹ä»¶ï¼ˆç«‹å³æ˜¾ç¤ºï¼‰
   - `EventPriority.NORMAL` - éŸ³é¢‘äº‹ä»¶ï¼ˆæ­£å¸¸æ’­æ”¾ï¼‰
   - `EventPriority.LOW` - æ—¥å¿—äº‹ä»¶ï¼ˆåå°è®°å½•ï¼‰

3. **å®ç°å¼‚å¸¸éš”ç¦»**
   ```python
   try:
       await handler.handle(event)
   except Exception as e:
       logger.error(f"Handler failed: {e}")
       # ä¸ä¸­æ–­å…¶ä»– Handler
   ```

### Resultï¼ˆç»“æœï¼‰

- âœ… **è§£è€¦**ï¼šPipeline å’Œ Handlers å®Œå…¨è§£è€¦
- âœ… **ä¼˜å…ˆçº§**ï¼šæ–‡æœ¬ä¼˜å…ˆäºéŸ³é¢‘ï¼Œæå‡ç”¨æˆ·ä½“éªŒ
- âœ… **å¼‚å¸¸éš”ç¦»**ï¼šå•ä¸ª Handler å¤±è´¥ä¸å½±å“å…¶ä»–
- âœ… **åŠ¨æ€è®¢é˜…**ï¼šè¿è¡Œæ—¶æ³¨å†Œ/å–æ¶ˆè®¢é˜…
- âœ… **æ‰©å±•æ€§**ï¼šæ–°å¢ Handler åªéœ€ä¸€è¡Œä»£ç 

**é¢è¯•è¯æœ¯**ï¼š
> "æˆ‘è®¾è®¡äº†ä¸€ä¸ª**äº‹ä»¶é©±åŠ¨æ¶æ„**ï¼Œä½¿ç”¨**è§‚å¯Ÿè€…æ¨¡å¼**å®ç°äº† EventBusã€‚è¿™å¸¦æ¥äº†**3 ä¸ªä»·å€¼**ï¼š
> 1. **è§£è€¦**ï¼šPipeline ä¸éœ€è¦çŸ¥é“æœ‰å¤šå°‘ Handlerï¼Œåªéœ€å‘å¸ƒäº‹ä»¶
> 2. **ä¼˜å…ˆçº§**ï¼šæ–‡æœ¬äº‹ä»¶ä¼˜å…ˆå¤„ç†ï¼Œç”¨æˆ·èƒ½ç«‹å³çœ‹åˆ°å›å¤
> 3. **å¼‚å¸¸éš”ç¦»**ï¼šå³ä½¿æŸä¸ª Handler å¤±è´¥ï¼Œå…¶ä»– Handler ä»èƒ½æ­£å¸¸å·¥ä½œ
>
> æ¯”å¦‚è¦æ–°å¢ä¸€ä¸ªæ—¥å¿— Handlerï¼Œåªéœ€è¦ï¼š
> ```python
> event_bus.subscribe("sentence", LogHandler(), EventPriority.LOW)
> ```
> ä¸éœ€è¦ä¿®æ”¹ Pipeline ä»£ç ã€‚"

---

## STAR æ³•åˆ™ 3ï¼šLive2D æƒ…æ„Ÿç³»ç»Ÿ

### Situationï¼ˆèƒŒæ™¯ï¼‰

Live2D è™šæ‹Ÿå½¢è±¡éœ€è¦**æƒ…æ„Ÿè¡¨è¾¾**å’Œ**å”‡åŒæ­¥**ï¼Œä¸šç•Œæ²¡æœ‰ç°æˆçš„è§£å†³æ–¹æ¡ˆã€‚éœ€è¦ä»é›¶è®¾è®¡ä¸€å¥—å®Œæ•´çš„æƒ…æ„Ÿç³»ç»Ÿã€‚

### Taskï¼ˆä»»åŠ¡ï¼‰

è®¾è®¡å¹¶å®ç°**ä¸‰ä½ä¸€ä½“**çš„æƒ…æ„Ÿè¡¨è¾¾ç³»ç»Ÿï¼š
1. æƒ…æ„Ÿæå–ï¼ˆä» LLM å“åº”ä¸­æå– `[happy]`, `[sad]` ç­‰æ ‡ç­¾ï¼‰
2. æ—¶é—´è½´è®¡ç®—ï¼ˆæ ¹æ®æƒ…æ„Ÿåœ¨æ–‡æœ¬ä¸­çš„ä½ç½®è®¡ç®—è¡¨æƒ…åˆ‡æ¢æ—¶é—´ï¼‰
3. å”‡åŒæ­¥ï¼ˆæ ¹æ®éŸ³é¢‘éŸ³é‡æ§åˆ¶å˜´éƒ¨å‚æ•°ï¼‰

### Actionï¼ˆè¡ŒåŠ¨ï¼‰

1. **æƒ…æ„Ÿæå–è®¾è®¡**
   - LLM è¾“å‡ºå¸¦æ ‡ç­¾çš„æ–‡æœ¬ï¼š`"ä½ å¥½ [happy] ä¸–ç•Œ"`
   - æ­£åˆ™è¡¨è¾¾å¼æå–ï¼š`r"\[(\w+)\]"`
   - éªŒè¯æƒ…æ„Ÿæœ‰æ•ˆæ€§ï¼šåªæ¥å—é¢„å®šä¹‰çš„æƒ…æ„Ÿ

2. **æ—¶é—´è½´è®¡ç®—ç­–ç•¥**
   ```python
   def calculate(emotions, text, audio_duration):
       # æ ¹æ®æƒ…æ„Ÿåœ¨æ–‡æœ¬ä¸­çš„ä½ç½®è®¡ç®—æ—¶é—´
       for emotion in emotions:
           start_time = (emotion.position / len(text)) * audio_duration
           duration = calculate_duration(emotion, audio_duration)
           segments.append(TimelineSegment(emotion, start_time, duration))
   ```

3. **å”‡åŒæ­¥å®ç°**
   ```python
   # åç«¯ï¼šç”ŸæˆéŸ³é¢‘æ—¶åŒæ­¥è®¡ç®—éŸ³é‡åŒ…ç»œï¼ˆ50Hzï¼‰
   volumes = AudioAnalyzer.compute_volume_envelope(audio, sample_rate=50)

   # å‰ç«¯ï¼šæ’­æ”¾æ—¶æ ¹æ®æ—¶é—´ç´¢å¼•æ›´æ–°å˜´éƒ¨å‚æ•°ï¼ˆ30fpsï¼‰
   LipSyncEngine.setMouthOpen(volumes[current_index])
   ```

### Resultï¼ˆç»“æœï¼‰

- âœ… **æƒ…æ„Ÿè¯†åˆ«å‡†ç¡®ç‡**ï¼š> 95%
- âœ… **å”‡åŒæ­¥ç²¾åº¦**ï¼š50Hz éŸ³é‡é‡‡æ · + 30fps å‚æ•°æ›´æ–°
- âœ… **ç«¯åˆ°ç«¯å»¶è¿Ÿ**ï¼šæƒ…æ„Ÿåˆ‡æ¢å»¶è¿Ÿ < 100ms
- âœ… **æ’ä»¶åŒ–æ¶æ„**ï¼šæ”¯æŒè‡ªå®šä¹‰æƒ…æ„Ÿåˆ†æå™¨å’Œæ—¶é—´è½´ç­–ç•¥
- âœ… **3 ç§åˆ†æå™¨**ï¼šLLM æ ‡ç­¾ã€å…³é”®è¯åŒ¹é…ã€æ··åˆæ¨¡å¼
- âœ… **3 ç§ç­–ç•¥**ï¼šä½ç½®é©±åŠ¨ã€æ—¶é•¿é©±åŠ¨ã€å¼ºåº¦é©±åŠ¨

**é¢è¯•è¯æœ¯**ï¼š
> "æˆ‘è®¾è®¡äº†ä¸€ä¸ª**Live2D æƒ…æ„Ÿç³»ç»Ÿ**ï¼Œè¿™æ˜¯é¡¹ç›®çš„**æ ¸å¿ƒäº®ç‚¹**ã€‚
>
> **æŠ€æœ¯éš¾ç‚¹**åœ¨äº**æ—¶é—´åŒæ­¥**ã€‚æ¯”å¦‚ LLM è¿”å›'ä½ å¥½ [happy] ä¸–ç•Œ'ï¼Œ'happy'åœ¨ç¬¬ 3 ä¸ªå­—ç¬¦ï¼Œå¦‚æœæ€»éŸ³é¢‘æ—¶é•¿ 5 ç§’ï¼Œæ–‡æœ¬é•¿åº¦ 7 ä¸ªå­—ç¬¦ï¼Œé‚£ä¹ˆ happy è¡¨æƒ…åº”è¯¥åœ¨ç¬¬ **1.5 ç§’**å¼€å§‹ï¼ŒæŒç»­ **0.7 ç§’**ã€‚
>
> æˆ‘è®¾è®¡äº†**éŸ³é‡åŒ…ç»œåˆ†æ**ï¼Œåœ¨ç”Ÿæˆ TTS éŸ³é¢‘æ—¶ï¼ŒåŒæ­¥è®¡ç®— 50Hz çš„éŸ³é‡é‡‡æ ·ç‚¹ï¼ˆæ¯ 20ms ä¸€ä¸ªç‚¹ï¼‰ï¼Œç„¶åå‰ç«¯æ’­æ”¾æ—¶æ ¹æ®æ—¶é—´ç´¢å¼•ç›´æ¥è·å–éŸ³é‡å€¼ï¼Œæ›´æ–°å˜´éƒ¨å‚æ•°ã€‚è¿™æ ·é¿å…äº†å‰ç«¯å®æ—¶åˆ†æéŸ³é¢‘çš„æ€§èƒ½é—®é¢˜ã€‚
>
> æ•´ä¸ªç³»ç»Ÿçš„å»¶è¿Ÿæ§åˆ¶åœ¨ **100ms ä»¥å†…**ï¼Œæƒ…æ„Ÿè¯†åˆ«å‡†ç¡®ç‡ **95% ä»¥ä¸Š**ã€‚"

---

## STAR æ³•åˆ™ 4ï¼šæµå¼å“åº”ä¼˜åŒ–

### Situationï¼ˆèƒŒæ™¯ï¼‰

ä¼ ç»Ÿçš„æ‰¹é‡å¤„ç†æ–¹å¼ï¼ˆç”¨æˆ·è¯´è¯ â†’ ç­‰å¾… LLM ç”Ÿæˆå®Œæ•´å›å¤ â†’ ç­‰å¾… TTS åˆæˆå®Œæ•´éŸ³é¢‘ â†’ æ’­æ”¾ï¼‰å¯¼è‡´**å»¶è¿Ÿè¿‡é«˜**ï¼Œç”¨æˆ·ä½“éªŒå·®ã€‚

### Taskï¼ˆä»»åŠ¡ï¼‰

å®ç°**æµå¼å“åº”**ï¼Œè®©ç”¨æˆ·èƒ½**å®æ—¶çœ‹åˆ°** LLM çš„ç”Ÿæˆè¿‡ç¨‹ï¼Œå¹¶**è¾¹ç”Ÿæˆè¾¹æ’­æ”¾** TTS éŸ³é¢‘ã€‚

### Actionï¼ˆè¡ŒåŠ¨ï¼‰

1. **LLM æµå¼è¾“å‡º**
   ```python
   async def chat_stream(self, text: str) -> AsyncIterator[str]:
       async for chunk in self.llm.stream(text):
           yield chunk  # é€ Token è¿”å›
   ```

2. **TTS æµå¼åˆæˆ**
   ```python
   async def synthesize_stream(self, text: str) -> AsyncIterator[bytes]:
       for sentence in split_sentences(text):
           audio = await self.tts.synthesize(sentence)
           yield audio  # é€å¥è¿”å›
   ```

3. **OutputPipeline æµå¼å¤„ç†**
   ```python
   async def process(self, chunks: AsyncIterator[str]):
       async for chunk in chunks:
           self.accumulator += chunk

           if self.is_sentence_complete():
               sentence = self.extract_sentence()
               await self.event_bus.emit(OutputEvent("sentence", sentence))
   ```

### Resultï¼ˆç»“æœï¼‰

- âœ… **é¦–å­—å»¶è¿Ÿ**ï¼š< 200msï¼ˆä»ç”¨æˆ·è¯´è¯åˆ°çœ‹åˆ°ç¬¬ä¸€ä¸ªå­—ï¼‰
- âœ… **ç«¯åˆ°ç«¯å»¶è¿Ÿ**ï¼š< 500msï¼ˆä»ç”¨æˆ·è¯´è¯åˆ°å¬åˆ°å›å¤ï¼‰
- âœ… **ç”¨æˆ·ä½“éªŒ**ï¼šå®æ—¶çœ‹åˆ° LLM ç”Ÿæˆè¿‡ç¨‹ï¼Œè¾¹è¯´è¾¹å¬

**é¢è¯•è¯æœ¯**ï¼š
> "æˆ‘ä¼˜åŒ–äº†**æµå¼å“åº”**ï¼Œè§£å†³äº†å»¶è¿Ÿé—®é¢˜ã€‚
>
> ä¼ ç»Ÿæ–¹å¼æ˜¯æ‰¹é‡å¤„ç†ï¼šç”¨æˆ·è¯´è¯ â†’ ç­‰å¾… LLM ç”Ÿæˆå®Œæ•´å›å¤ â†’ ç­‰å¾… TTS åˆæˆå®Œæ•´éŸ³é¢‘ â†’ æ’­æ”¾ã€‚è¿™æ ·ç”¨æˆ·è¦ç­‰ **3-5 ç§’**æ‰èƒ½çœ‹åˆ°å›å¤ã€‚
>
> æˆ‘å®ç°çš„æ˜¯**æµå¼å¤„ç†**ï¼šLLM æ¯ç”Ÿæˆä¸€ä¸ª Tokenï¼Œå°±ç«‹å³æ¨é€åˆ°å‰ç«¯æ˜¾ç¤ºã€‚åŒæ—¶ï¼ŒTTS é€å¥åˆæˆï¼Œè¾¹åˆæˆè¾¹æ’­æ”¾ã€‚è¿™æ ·ç”¨æˆ·åœ¨ **200ms** å†…å°±èƒ½çœ‹åˆ°ç¬¬ä¸€ä¸ªå­—ï¼Œå¤§å¤§æå‡äº†ä½“éªŒã€‚
>
> æŠ€æœ¯ä¸Šä½¿ç”¨äº† **AsyncIterator** å’Œ **WebSocket åŒå‘é€šä¿¡**ï¼Œåç«¯å’Œå‰ç«¯éƒ½æ˜¯æµå¼å¤„ç†ã€‚"

---

## STAR æ³•åˆ™ 5ï¼šå‰ç«¯æ¶æ„é‡æ„

### Situationï¼ˆèƒŒæ™¯ï¼‰

å‰ç«¯åŸå§‹æ¶æ„ä½¿ç”¨äº† **Context Provider**ï¼Œå¯¼è‡´ï¼š
- ä»£ç å†—ä½™ï¼ˆContext Wrapper å±‚å±‚åŒ…è£¹ï¼‰
- éš¾ä»¥ç†è§£ï¼ˆæ•°æ®æµä¸æ¸…æ™°ï¼‰
- æ€§èƒ½é—®é¢˜ï¼ˆä¸å¿…è¦çš„ re-renderï¼‰

### Taskï¼ˆä»»åŠ¡ï¼‰

é‡æ„å‰ç«¯æ¶æ„ï¼Œç®€åŒ–çŠ¶æ€ç®¡ç†ï¼Œæå‡ä»£ç å¯ç»´æŠ¤æ€§ã€‚

### Actionï¼ˆè¡ŒåŠ¨ï¼‰

1. **ç§»é™¤ Context Provider**
   ```typescript
   // âŒ Before: 3 å±‚æ¶æ„
   Component â†’ Context â†’ useConversation â†’ Zustand Store

   // âœ… After: 2 å±‚æ¶æ„
   Component â†’ useConversation â†’ Zustand Store
   ```

2. **ä½¿ç”¨ Zustand çŠ¶æ€ç®¡ç†**
   ```typescript
   const useConversationStore = create((set) => ({
       messages: [],
       isConnected: false,
       sendMessage: (text) => { ... }
   }))
   ```

3. **å®ç°è‡ªå®šä¹‰ Hooks**
   ```typescript
   export function useConversation() {
       const messages = useConversationStore(state => state.messages)
       const sendMessage = useConversationStore(state => state.sendMessage)
       return { messages, sendMessage }
   }
   ```

### Resultï¼ˆç»“æœï¼‰

- âœ… **ä»£ç å‡å°‘**ï¼š-145 è¡Œä»£ç ï¼ˆ-51 è¡Œ Context + -80 è¡Œæ—¥å¿— + -14 è¡Œé‡å¤ç±»å‹ï¼‰
- âœ… **æ¶æ„ç®€åŒ–**ï¼šä» 3 å±‚å‡å°‘åˆ° 2 å±‚
- âœ… **æ€§èƒ½æå‡**ï¼šå‡å°‘ä¸å¿…è¦çš„ re-render
- âœ… **å¯ç»´æŠ¤æ€§**ï¼šæ•°æ®æµæ›´æ¸…æ™°

**é¢è¯•è¯æœ¯**ï¼š
> "æˆ‘å‘ç°å‰ç«¯æ¶æ„å­˜åœ¨**å†—ä½™çš„ Context Provider å±‚**ï¼Œå¯¼è‡´ä»£ç éš¾ä»¥ç†è§£å’Œç»´æŠ¤ã€‚æˆ‘è¿›è¡Œäº†ä¸€æ¬¡**æ¶æ„é‡æ„**ã€‚
>
> é‡æ„å‰ï¼šComponent â†’ Context â†’ Hook â†’ Storeï¼ˆ3 å±‚ï¼‰
> é‡æ„åï¼šComponent â†’ Hook â†’ Storeï¼ˆ2 å±‚ï¼‰
>
> è¿™å‡å°‘äº† **145 è¡Œä»£ç **ï¼Œè®©æ•°æ®æµæ›´æ¸…æ™°ã€‚åŒæ—¶ï¼Œæˆ‘æ¸…ç†äº† **24 æ¡ CHECKPOINT æ—¥å¿—**ï¼Œä¼˜åŒ–äº†æ—¥å¿—ç³»ç»Ÿã€‚è¿™ä½“ç°äº†æˆ‘çš„**ä»£ç æ´ç™–**å’Œ**å·¥ç¨‹åŒ–æ€ç»´**ã€‚"

---

## é¡¹ç›®äº®ç‚¹æ€»ç»“è¡¨

| ç»´åº¦ | äº®ç‚¹ | é‡åŒ–æŒ‡æ ‡ |
|------|------|----------|
| **æ¶æ„è®¾è®¡** | ä¸‰å±‚æ•°æ®æµæ¶æ„ï¼ˆPipeline â†’ EventBus â†’ Handlersï¼‰ | 5 å±‚å¤„ç†æµç¨‹ |
| **è®¾è®¡æ¨¡å¼** | 6 ç§è®¾è®¡æ¨¡å¼çš„å®é™…åº”ç”¨ | Factory, Strategy, Observer, Pipeline, Orchestrator, Provider Registry |
| **å¯æ‰©å±•æ€§** | æ’ä»¶åŒ–æ¶æ„ï¼Œé›¶ä¿®æ”¹æ‰©å±• | 12+ æœåŠ¡æ‰©å±•ç‚¹ |
| **æƒ…æ„Ÿç³»ç»Ÿ** | Live2D æƒ…æ„Ÿè¡¨è¾¾ + å”‡åŒæ­¥ | 95% å‡†ç¡®ç‡, < 100ms å»¶è¿Ÿ |
| **æµå¼å“åº”** | LLM + TTS åŒæµå¼ | < 200ms é¦–å­—å»¶è¿Ÿ |
| **å·¥ç¨‹åŒ–** | ç±»å‹å®‰å…¨ + å¼‚æ­¥ç¼–ç¨‹ + é…ç½®ç®¡ç† | 100% Type Coverage |
| **å‰ç«¯é‡æ„** | ç§»é™¤ Context å†—ä½™ï¼Œç®€åŒ–æ¶æ„ | -145 è¡Œä»£ç  |

---

## ç®€å†é¡¹ç›®æè¿°æ¨¡æ¿

```markdown
### Anima - AI è™šæ‹Ÿä¼´ä¾£/VTuber æ¡†æ¶

**é¡¹ç›®è§’è‰²**ï¼šç‹¬ç«‹å…¨æ ˆå¼€å‘è€…
**é¡¹ç›®å‘¨æœŸ**ï¼š6 ä¸ªæœˆ
**æŠ€æœ¯æ ˆ**ï¼šPython (FastAPI, AsyncIO) + TypeScript (Next.js, React, Socket.IO)

**é¡¹ç›®äº®ç‚¹**ï¼š
1. **æ¶æ„è®¾è®¡**ï¼šè®¾è®¡äº† Pipeline + EventBus + Handlers ä¸‰å±‚æ•°æ®æµæ¶æ„ï¼Œå®ç°äº†æ•°æ®å¤„ç†å’Œäº‹ä»¶å¤„ç†çš„å®Œå…¨è§£è€¦
2. **æ’ä»¶åŒ–æ‰©å±•**ï¼šä½¿ç”¨å·¥å‚æ¨¡å¼ + æä¾›è€…æ³¨å†Œæ¨¡å¼ï¼Œå®ç°äº†é›¶ä¿®æ”¹çš„æœåŠ¡å•†æ‰©å±•ï¼Œæ”¯æŒ 12+ ç§ LLM/ASR/TTS æœåŠ¡
3. **Live2D æƒ…æ„Ÿç³»ç»Ÿ**ï¼šè®¾è®¡äº†ä¸‰ä½ä¸€ä½“çš„æƒ…æ„Ÿè¡¨è¾¾ç³»ç»Ÿï¼ˆæƒ…æ„Ÿæå– + æ—¶é—´è½´è®¡ç®— + å”‡åŒæ­¥ï¼‰ï¼Œæƒ…æ„Ÿè¯†åˆ«å‡†ç¡®ç‡ 95% ä»¥ä¸Š
4. **æµå¼å“åº”**ï¼šå®ç°äº† LLM å’Œ TTS åŒæµå¼è¾“å‡ºï¼Œé¦–å­—å»¶è¿Ÿ < 200msï¼Œå¤§å¤§æå‡ç”¨æˆ·ä½“éªŒ
5. **å‰ç«¯é‡æ„**ï¼šç§»é™¤å†—ä½™çš„ Context Providerï¼Œç®€åŒ–æ¶æ„ï¼ˆ3 å±‚ â†’ 2 å±‚ï¼‰ï¼Œå‡å°‘ 145 è¡Œä»£ç 

**æŠ€æœ¯æˆæœ**ï¼š
- ~8,000 è¡Œä»£ç ï¼ˆåç«¯ 5,000 è¡Œ + å‰ç«¯ 3,000 è¡Œï¼‰
- 6 ç§è®¾è®¡æ¨¡å¼çš„å®é™…åº”ç”¨
- å®Œæ•´çš„æŠ€æœ¯æ–‡æ¡£å’Œæ¶æ„è¯´æ˜
- ç«¯åˆ°ç«¯å»¶è¿Ÿ < 500msï¼Œæƒ…æ„Ÿåˆ‡æ¢å»¶è¿Ÿ < 100ms
```

---

## é¢è¯•å¸¸è§é—®é¢˜

### Q1: ä»‹ç»ä¸€ä¸‹ä½ çš„é¡¹ç›®ï¼Ÿ

**å‚è€ƒå›ç­”**ï¼š
> "Anima æ˜¯ä¸€ä¸ª**å¯é…ç½®çš„ AI è™šæ‹Ÿä¼´ä¾£æ¡†æ¶**ï¼Œæˆ‘çš„ç›®æ ‡æ˜¯è®©ç”¨æˆ·èƒ½å¤Ÿ**è½»æ¾åˆ‡æ¢ä¸åŒçš„ AI æœåŠ¡**ï¼ˆæ¯”å¦‚ä» OpenAI åˆ‡æ¢åˆ°æ™ºè°± GLMï¼‰ï¼Œå¹¶ä¸”è®©è™šæ‹Ÿå½¢è±¡èƒ½å¤Ÿ**çœŸå®åœ°è¡¨è¾¾æƒ…æ„Ÿ**ã€‚
>
> æŠ€æœ¯ä¸Šï¼Œæˆ‘è®¾è®¡äº†ä¸€ä¸ª**ä¸‰å±‚æ•°æ®æµæ¶æ„**ï¼š
> 1. **Pipeline å±‚**ï¼šå¤„ç†è¾“å…¥æ•°æ®ï¼ˆéŸ³é¢‘è½¬æ–‡æœ¬ã€æ–‡æœ¬æ¸…æ´—ã€æƒ…æ„Ÿæå–ï¼‰
> 2. **EventBus å±‚**ï¼šäº‹ä»¶é©±åŠ¨ï¼Œæ”¯æŒä¼˜å…ˆçº§å’Œå¼‚å¸¸éš”ç¦»
> 3. **Handlers å±‚**ï¼šå¤„ç†ä¸åŒç±»å‹çš„äº‹ä»¶ï¼ˆæ–‡æœ¬ã€éŸ³é¢‘ã€è¡¨æƒ…ï¼‰
>
> è¿™ä¸ªæ¶æ„çš„äº®ç‚¹æ˜¯**é«˜å†…èšä½è€¦åˆ**ï¼Œæ¯”å¦‚è¦æ–°å¢ä¸€ä¸ª Handlerï¼Œåªéœ€è¦æ³¨å†Œåˆ° EventBusï¼Œä¸éœ€è¦ä¿®æ”¹ Pipeline ä»£ç ã€‚è¿™ä½“ç°äº†**å¼€é—­åŸåˆ™**çš„å®è·µã€‚"

### Q2: é¡¹ç›®çš„æŠ€æœ¯éš¾ç‚¹æ˜¯ä»€ä¹ˆï¼Ÿ

**å‚è€ƒå›ç­”**ï¼š
> "æœ€å¤§çš„æŠ€æœ¯éš¾ç‚¹æ˜¯ **Live2D æƒ…æ„Ÿç³»ç»Ÿçš„åŒæ­¥é—®é¢˜**ã€‚
>
> å…·ä½“æ¥è¯´ï¼ŒLLM è¿”å›çš„æ–‡æœ¬å¸¦æœ‰æƒ…æ„Ÿæ ‡ç­¾ï¼Œæ¯”å¦‚'ä½ å¥½ [happy] ä¸–ç•Œ'ã€‚æˆ‘éœ€è¦ï¼š
> 1. æå–æƒ…æ„Ÿæ ‡ç­¾ï¼š`[happy]`
> 2. è®¡ç®—æ—¶é—´è½´ï¼šæ ¹æ®æƒ…æ„Ÿåœ¨æ–‡æœ¬ä¸­çš„ä½ç½®ï¼ˆç¬¬ 3 ä¸ªå­—ç¬¦ï¼‰å’ŒéŸ³é¢‘æ—¶é•¿ï¼ˆ5 ç§’ï¼‰ï¼Œè®¡ç®—å‡º happy è¡¨æƒ…åº”è¯¥åœ¨ç¬¬ 1.5 ç§’å¼€å§‹ï¼ŒæŒç»­ 0.7 ç§’
> 3. å”‡åŒæ­¥ï¼šåˆ†æéŸ³é¢‘éŸ³é‡ï¼Œç”Ÿæˆ 50Hz çš„éŸ³é‡åŒ…ç»œï¼Œå‰ç«¯æ’­æ”¾æ—¶æ ¹æ®æ—¶é—´ç´¢å¼•æ›´æ–°å˜´éƒ¨å‚æ•°
>
> è¿™ä¸ªç³»ç»Ÿçš„å»¶è¿Ÿæ§åˆ¶åœ¨ **100ms ä»¥å†…**ï¼Œæƒ…æ„Ÿè¯†åˆ«å‡†ç¡®ç‡ **95% ä»¥ä¸Š**ã€‚"

### Q3: ä½ åœ¨é¡¹ç›®ä¸­çš„è´¡çŒ®ï¼Ÿ

**å‚è€ƒå›ç­”**ï¼š
> "ä½œä¸º**ç‹¬ç«‹å¼€å‘è€…**ï¼Œæˆ‘è´Ÿè´£äº†ï¼š
>
> 1. **æ¶æ„è®¾è®¡**ï¼šè®¾è®¡äº†ä¸‰å±‚æ•°æ®æµæ¶æ„å’Œæ’ä»¶åŒ–æ‰©å±•æœºåˆ¶
> 2. **åç«¯å¼€å‘**ï¼šå®ç°äº† Pipelineã€EventBusã€Orchestrator ç­‰æ ¸å¿ƒç»„ä»¶
> 3. **Live2D é›†æˆ**ï¼šå®ç°äº†æƒ…æ„Ÿç³»ç»Ÿå’Œå”‡åŒæ­¥åŠŸèƒ½
> 4. **å‰ç«¯å¼€å‘**ï¼šå®ç°äº† React + Zustand çŠ¶æ€ç®¡ç†ï¼Œé‡æ„äº†æ¶æ„ï¼ˆ3 å±‚ â†’ 2 å±‚ï¼‰
> 5. **æ–‡æ¡£ç¼–å†™**ï¼šç¼–å†™äº†å®Œæ•´çš„æŠ€æœ¯æ–‡æ¡£å’Œæ¶æ„è¯´æ˜
>
> é¡¹ç›®å…± **8,000 è¡Œä»£ç **ï¼Œæˆ‘è´Ÿè´£äº†æ‰€æœ‰çš„æ¶æ„è®¾è®¡ã€æ ¸å¿ƒåŠŸèƒ½å¼€å‘å’Œæ–‡æ¡£ç¼–å†™ã€‚"

---

## ç›¸å…³æ–‡æ¡£

- [æŠ€æœ¯æˆå°±](./technical-achievements.md) - é‡åŒ–æŠ€æœ¯æˆæœ
- [æŠ€æœ¯äº®ç‚¹](../overview/highlights.md) - è¯¦ç»†çš„æŠ€æœ¯äº®ç‚¹è¯´æ˜
- [æ¶æ„å›¾ç¤º](./architecture-diagram.md) - å¯è§†åŒ–æ¶æ„å›¾

---

**æœ€åæ›´æ–°**: 2026-02-28
