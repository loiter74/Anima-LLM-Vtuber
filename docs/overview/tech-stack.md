# æŠ€æœ¯æ ˆå…¨æ™¯

> ğŸ“ **æŠ€æœ¯é€‰å‹è¯´æ˜** - ä¸ºä»€ä¹ˆé€‰æ‹©è¿™äº›æŠ€æœ¯ï¼Œæ›¿ä»£æ–¹æ¡ˆæ˜¯ä»€ä¹ˆ

---

## ç›®å½•

1. [æŠ€æœ¯æ ˆæ€»è§ˆ](#æŠ€æœ¯æ ˆæ€»è§ˆ)
2. [åç«¯æŠ€æœ¯é€‰å‹](#åç«¯æŠ€æœ¯é€‰å‹)
3. [å‰ç«¯æŠ€æœ¯é€‰å‹](#å‰ç«¯æŠ€æœ¯é€‰å‹)
4. [Live2D æŠ€æœ¯é€‰å‹](#live2d-æŠ€æœ¯é€‰å‹)
5. [åŸºç¡€è®¾æ–½é€‰å‹](#åŸºç¡€è®¾æ–½é€‰å‹)
6. [é¢è¯•é—®ç­”](#é¢è¯•é—®ç­”)

---

## æŠ€æœ¯æ ˆæ€»è§ˆ

### åˆ†å±‚æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        ç”¨æˆ·å±‚                              â”‚
â”‚  (æµè§ˆå™¨ã€ç§»åŠ¨ç«¯ã€æ¡Œé¢åº”ç”¨)                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      å‰ç«¯æŠ€æœ¯æ ˆ                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚ Next.js 16   â”‚  â”‚ React 19     â”‚  â”‚ Zustand      â”‚       â”‚
â”‚  â”‚ (SSR + Router)â”‚  â”‚ (Hooks + Concurrency)â”‚  â”‚ (State Mgmt) â”‚â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚ Socket.IO    â”‚  â”‚ pixi-live2d  â”‚  â”‚ TypeScript   â”‚       â”‚
â”‚  â”‚ (WebSocket)  â”‚  â”‚ (Live2D)     â”‚  â”‚ (Type Safe)  â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      åç«¯æŠ€æœ¯æ ˆ                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚ FastAPI      â”‚  â”‚ AsyncIO      â”‚  â”‚ Pydantic     â”‚       â”‚
â”‚  â”‚ (Web æ¡†æ¶)   â”‚  â”‚ (å¼‚æ­¥è¿è¡Œæ—¶)  â”‚  â”‚ (æ•°æ®éªŒè¯)   â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚ Socket.IO    â”‚  â”‚ Pydantic     â”‚  â”‚ Loguru       â”‚       â”‚
â”‚  â”‚ (WebSocket)  â”‚  â”‚ (Settings)   â”‚  â”‚ (Logging)    â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      AI æœåŠ¡å±‚                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚ OpenAI API   â”‚  â”‚ GLM API      â”‚  â”‚ Ollama       â”‚       â”‚
â”‚  â”‚ (LLM)        â”‚  â”‚ (LLM + ASR)  â”‚  â”‚ (Local LLM)  â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚ Faster-      â”‚  â”‚ Edge TTS     â”‚  â”‚ Silero VAD   â”‚       â”‚
â”‚  â”‚ Whisper      â”‚  â”‚ (TTS)        â”‚  â”‚ (VAD)        â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      åŸºç¡€è®¾æ–½                               â”‚
â”‚  Python 3.8+  â”‚  Node.js 18+  â”‚  Git  â”‚  VS Code        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## åç«¯æŠ€æœ¯é€‰å‹

### 1. Web æ¡†æ¶ï¼šFastAPI

**é€‰æ‹©**ï¼šFastAPI

**æ›¿ä»£æ–¹æ¡ˆ**ï¼šFlask, Django, Tornado

**ä¸ºä»€ä¹ˆé€‰ FastAPIï¼Ÿ**

| ç‰¹æ€§ | FastAPI | Flask | Django |
|------|---------|-------|--------|
| **æ€§èƒ½** | â­â­â­â­â­ (Starlette) | â­â­â­ | â­â­ |
| **å¼‚æ­¥æ”¯æŒ** | âœ… åŸç”Ÿ AsyncIO | âŒ éœ€è¦æ‰©å±• | âœ… 3.0+ æ”¯æŒ |
| **ç±»å‹æç¤º** | âœ… è‡ªåŠ¨ç”Ÿæˆ OpenAPI | âŒ æ‰‹åŠ¨ç¼–å†™ | âš ï¸ éƒ¨åˆ†æ”¯æŒ |
| **WebSocket** | âœ… åŸç”Ÿæ”¯æŒ | âŒ éœ€è¦åº“ | âœ… Channels |
| **æ–‡æ¡£** | âœ… è‡ªåŠ¨ç”Ÿæˆ | âŒ æ‰‹åŠ¨ç¼–å†™ | âš ï¸ éœ€è¦æ‰©å±• |
| **å­¦ä¹ æ›²çº¿** | â­â­ ä¸­ç­‰ | â­ ç®€å• | â­â­â­ é™¡å³­ |

**å†³ç­–ä¾æ®**ï¼š

1. **å¼‚æ­¥ä¼˜å…ˆ**ï¼šAnima æ˜¯å®æ—¶åº”ç”¨ï¼Œéœ€è¦ AsyncIO
2. **ç±»å‹å®‰å…¨**ï¼šPydantic æä¾›è¿è¡Œæ—¶ç±»å‹éªŒè¯
3. **WebSocket**ï¼šåŸç”Ÿæ”¯æŒï¼Œä¸éœ€è¦é¢å¤–åº“
4. **æ€§èƒ½**ï¼šåŸºäº Starletteï¼Œæ€§èƒ½æ¥è¿‘ Go/Nginx

**ä»£ç ç¤ºä¾‹**ï¼š

```python
# FastAPI - å¼‚æ­¥ WebSocket ç«¯ç‚¹
from fastapi import FastAPI
from fastapi import WebSocket

app = FastAPI()

@app.websocket("/ws")
async def websocket_endpoint(websocket: WebSocket):
    await websocket.accept()
    while True:
        data = await websocket.receive_text()
        await websocket.send_text(f"Echo: {data}")
```

### 2. å¼‚æ­¥æ¡†æ¶ï¼šAsyncIO

**é€‰æ‹©**ï¼šAsyncIOï¼ˆPython æ ‡å‡†åº“ï¼‰

**æ›¿ä»£æ–¹æ¡ˆ**ï¼šTrio, Curio

**ä¸ºä»€ä¹ˆé€‰ AsyncIOï¼Ÿ**

| ç‰¹æ€§ | AsyncIO | Trio | Curio |
|------|---------|------|-------|
| **æ ‡å‡†åº“** | âœ… Python 3.4+ å†…ç½® | âŒ ç¬¬ä¸‰æ–¹åº“ | âŒ ç¬¬ä¸‰æ–¹åº“ |
| **ç”Ÿæ€** | â­â­â­â­â­ å¹¿æ³› | â­â­â­ æœ‰é™ | â­â­ æœ‰é™ |
| **æ€§èƒ½** | â­â­â­â­ ä¼˜ç§€ | â­â­â­â­ æ›´å¥½ | â­â­â­â­ æ›´å¥½ |
| **å­¦ä¹ èµ„æº** | â­â­â­â­â­ ä¸°å¯Œ | â­â­â­ ä¸€èˆ¬ | â­â­ ç¨€å°‘ |

**å†³ç­–ä¾æ®**ï¼š

1. **å®˜æ–¹æ”¯æŒ**ï¼šPython å†…ç½®ï¼Œä¸éœ€è¦é¢å¤–ä¾èµ–
2. **ç”Ÿæ€æˆç†Ÿ**ï¼šFastAPIã€Socket.IO éƒ½åŸºäº AsyncIO
3. **å­¦ä¹ èµ„æº**ï¼šå®˜æ–¹æ–‡æ¡£å®Œå–„ï¼Œç¤¾åŒºæ´»è·ƒ

**ä»£ç ç¤ºä¾‹**ï¼š

```python
import asyncio

async def main():
    # å¹¶å‘æ‰§è¡Œå¤šä¸ªä»»åŠ¡
    task1 = asyncio.create_task(asr_job())
    task2 = asyncio.create_task(tts_job())

    await asyncio.gather(task1, task2)

asyncio.run(main())
```

### 3. WebSocketï¼šSocket.IO

**é€‰æ‹©**ï¼špython-socketio

**æ›¿ä»£æ–¹æ¡ˆ**ï¼šWebSocket (åŸç”Ÿ), websockets

**ä¸ºä»€ä¹ˆé€‰ Socket.IOï¼Ÿ**

| ç‰¹æ€§ | Socket.IO | åŸç”Ÿ WebSocket | websockets |
|------|----------|---------------|-----------|
| **è‡ªåŠ¨é‡è¿** | âœ… å†…ç½® | âŒ éœ€è¦æ‰‹åŠ¨å®ç° | âŒ éœ€è¦æ‰‹åŠ¨å®ç° |
| **æˆ¿é—´ç®¡ç†** | âœ… å†…ç½® | âŒ éœ€è¦æ‰‹åŠ¨å®ç° | âŒ éœ€è¦æ‰‹åŠ¨å®ç° |
| **å¿ƒè·³æ£€æµ‹** | âœ… å†…ç½® | âŒ éœ€è¦æ‰‹åŠ¨å®ç° | âŒ éœ€è¦æ‰‹åŠ¨å®ç° |
| **è·¨æµè§ˆå™¨** | âœ… å…¼å®¹æ€§å¥½ | âš ï¸ éƒ¨åˆ†æ—§æµè§ˆå™¨ä¸æ”¯æŒ | âš ï¸ éƒ¨åˆ†æ—§æµè§ˆå™¨ä¸æ”¯æŒ |
| **åŒå‘é€šä¿¡** | âœ… æ”¯æŒ | âœ… æ”¯æŒ | âœ… æ”¯æŒ |

**å†³ç­–ä¾æ®**ï¼š

1. **ç”Ÿäº§åŠ›**ï¼šå†…ç½®é‡è¿ã€æˆ¿é—´ã€å¿ƒè·³ï¼Œå‡å°‘é‡å¤ä»£ç 
2. **å…¼å®¹æ€§**ï¼šå‰åç«¯éƒ½ä½¿ç”¨ Socket.IOï¼ŒAPI ä¸€è‡´
3. **æˆç†Ÿåº¦**ï¼šå¹¿æ³›ä½¿ç”¨ï¼Œç¤¾åŒºæ´»è·ƒ

**ä»£ç ç¤ºä¾‹**ï¼š

```python
# åç«¯
import socketio

sio = socketio.AsyncServer(async_mode='asgi')

@sio.event
async def connect(sid, environ):
    print(f"Client connected: {sid}")

@sio.event
async def message(sid, data):
    await sio.emit('response', f"Echo: {data}")
```

```typescript
// å‰ç«¯
import { io } from 'socket.io-client';

const socket = io('http://localhost:12394');
socket.on('connect', () => {
  console.log('Connected');
});
socket.on('response', (data) => {
  console.log('Received:', data);
});
```

### 4. æ•°æ®éªŒè¯ï¼šPydantic

**é€‰æ‹©**ï¼šPydantic

**æ›¿ä»£æ–¹æ¡ˆ**ï¼šCerberus, Marshmallow

**ä¸ºä»€ä¹ˆé€‰ Pydanticï¼Ÿ**

| ç‰¹æ€§ | Pydantic | Cerberus | Marshmallow |
|------|---------|----------|-------------|
| **ç±»å‹æç¤º** | âœ… åŸç”Ÿæ”¯æŒ | âŒ ä¸æ”¯æŒ | âš ï¸ æœ‰é™æ”¯æŒ |
| **æ€§èƒ½** | â­â­â­â­â­ Rust æ ¸å¿ƒ | â­â­â­ Python | â­â­â­ Python |
| **AsyncIO** | âœ… æ”¯æŒ | âŒ ä¸æ”¯æŒ | âš ï¸ æœ‰é™æ”¯æŒ |
| **FastAPI é›†æˆ** | âœ… æ·±åº¦é›†æˆ | âŒ éœ€è¦é€‚é… | âš ï¸ éœ€è¦é€‚é… |

**å†³ç­–ä¾æ®**ï¼š

1. **ç±»å‹å®‰å…¨**ï¼šä¸ Python Type Hints å®Œç¾é›†æˆ
2. **æ€§èƒ½**ï¼šRust æ ¸å¿ƒï¼Œæ¯”çº¯ Python å¿« 5-10 å€
3. **FastAPI é›†æˆ**ï¼šFastAPI æ·±åº¦é›†æˆ Pydantic

**ä»£ç ç¤ºä¾‹**ï¼š

```python
from pydantic import BaseModel, Field
from typing import Optional, Literal

class LLMConfig(BaseModel):
    type: Literal["openai", "glm", "ollama"]
    api_key: str
    model: str = "gpt-4"
    temperature: float = Field(default=0.7, ge=0.0, le=1.0)
    max_tokens: Optional[int] = None

# è¿è¡Œæ—¶éªŒè¯
config = LLMConfig(**data)
# è‡ªåŠ¨éªŒè¯ç±»å‹ã€èŒƒå›´ã€çº¦æŸ
```

### 5. æ—¥å¿—ï¼šloguru

**é€‰æ‹©**ï¼šloguru

**æ›¿ä»£æ–¹æ¡ˆ**ï¼šæ ‡å‡† logging, structlog

**ä¸ºä»€ä¹ˆé€‰ loguruï¼Ÿ**

| ç‰¹æ€§ | loguru | logging | structlog |
|------|--------|---------|----------|
| **æ˜“ç”¨æ€§** | â­â­â­â­â­ å¼€ç®±å³ç”¨ | â­â­ éœ€è¦é…ç½® | â­â­â­ éœ€è¦é…ç½® |
| **æ€§èƒ½** | â­â­â­â­ å¿« | â­â­â­ ä¸­ç­‰ | â­â­â­ ä¸­ç­‰ |
| **ç»“æ„åŒ–** | âœ… æ”¯æŒ bind | âš ï¸ éœ€è¦é€‚é… | âœ… åŸç”Ÿæ”¯æŒ |
| **å¼‚å¸¸æ•è·** | âœ… è‡ªåŠ¨æ•è· | âš ï¸ éœ€è¦æ‰‹åŠ¨ | âš ï¸ éœ€è¦æ‰‹åŠ¨ |
| **å½©è‰²è¾“å‡º** | âœ… è‡ªåŠ¨ | âš ï¸ éœ€è¦é…ç½® | âš ï¸ éœ€è¦é…ç½® |

**å†³ç­–ä¾æ®**ï¼š

1. **é›¶é…ç½®**ï¼š`logger.info("message")` ç›´æ¥ä½¿ç”¨
2. **ç»“æ„åŒ–**ï¼šæ”¯æŒ `bind(session_id=123)`ï¼Œä¾¿äºæŸ¥è¯¢
3. **å¼‚å¸¸æ•è·**ï¼šè‡ªåŠ¨è®°å½•å¼‚å¸¸å †æ ˆ

**ä»£ç ç¤ºä¾‹**ï¼š

```python
from loguru import logger

# ç®€å•ä½¿ç”¨
logger.info("Processing input", session_id="user-123")

# å¼‚å¸¸æ•è·
try:
    risky_operation()
except Exception as e:
    logger.error("Operation failed", exc_info=e)
    # è‡ªåŠ¨åŒ…å«å †æ ˆä¿¡æ¯
```

---

## å‰ç«¯æŠ€æœ¯é€‰å‹

### 1. æ¡†æ¶ï¼šNext.js

**é€‰æ‹©**ï¼šNext.js 16

**æ›¿ä»£æ–¹æ¡ˆ**ï¼šCreate React App, Vite + React

**ä¸ºä»€ä¹ˆé€‰ Next.jsï¼Ÿ**

| ç‰¹æ€§ | Next.js | CRA | Vite |
|------|--------|-----|------|
| **SSR** | âœ… æœåŠ¡ç«¯æ¸²æŸ“ | âŒ ä»…å®¢æˆ·ç«¯ | âŒ ä»…å®¢æˆ·ç«¯ |
| **è·¯ç”±** | âœ… æ–‡ä»¶ç³»ç»Ÿè·¯ç”± | âŒ éœ€è¦é…ç½® | âŒ éœ€è¦é…ç½® |
| **API Routes** | âœ… å†…ç½® | âŒ éœ€è¦é…ç½® | âŒ éœ€è¦é…ç½® |
| **ä¼˜åŒ–** | âœ… è‡ªåŠ¨ä¼˜åŒ– | âš ï¸ æ‰‹åŠ¨é…ç½® | âš ï¸ æ‰‹åŠ¨é…ç½® |
| **éƒ¨ç½²** | âœ… Vercel ä¸€é”®éƒ¨ç½² | âš ï¸ éœ€è¦é…ç½® | âš ï¸ éœ€è¦é…ç½® |

**å†³ç­–ä¾æ®**ï¼š

1. **æœåŠ¡ç«¯æ¸²æŸ“**ï¼šSEO å‹å¥½ï¼Œé¦–å±åŠ è½½å¿«
2. **æ–‡ä»¶ç³»ç»Ÿè·¯ç”±**ï¼š`pages/index.tsx` â†’ `/`ï¼Œç›´è§‚
3. **API Routes**ï¼šå‰åç«¯ç»Ÿä¸€ï¼Œä¸éœ€è¦å•ç‹¬çš„åç«¯

**ä»£ç ç¤ºä¾‹**ï¼š

```typescript
// pages/api/chat.ts
import type { NextRequest } from 'next/server';

export async function POST(request: NextRequest) {
  const { message } = await request.json();
  return Response.json({ reply: `Echo: ${message}` });
}
```

### 2. çŠ¶æ€ç®¡ç†ï¼šZustand

**é€‰æ‹©**ï¼šZustand

**æ›¿ä»£æ–¹æ¡ˆ**ï¼šRedux, MobX, Recoil

**ä¸ºä»€ä¹ˆé€‰ Zustandï¼Ÿ**

| ç‰¹æ€§ | Zustand | Redux | MobX |
|------|--------|-------|------|
| **å­¦ä¹ æ›²çº¿** | â­ ç®€å• | â­â­â­ é™¡å³­ | â­â­ ä¸­ç­‰ |
| **æ ·æ¿ä»£ç ** | â­â­â­ æå°‘ | â­ å¤§é‡ | â­â­ è¾ƒå°‘ |
| **æ€§èƒ½** | â­â­â­â­ ä¼˜ç§€ | â­â­â­ è‰¯å¥½ | â­â­â­â­ ä¼˜ç§€ |
| **DevTools** | â­â­â­ æœ‰ | â­â­â­â­ å®Œå–„ | â­â­â­ æœ‰ |
| **æŒä¹…åŒ–** | â­â­â­ ä¸­é—´ä»¶ | â­â­ éœ€è¦æ’ä»¶ | â­â­ éœ€è¦é…ç½® |

**å†³ç­–ä¾æ®**ï¼š

1. **ç®€æ´**ï¼šä»£ç å°‘ï¼Œæ˜“ç†è§£
2. **æ€§èƒ½**ï¼šåŸºäº React hooksï¼Œæ— é¢å¤–å¼€é”€
3. **TypeScript**ï¼šç±»å‹æ¨å¯¼ä¼˜ç§€

**ä»£ç ç¤ºä¾‹**ï¼š

```typescript
import create from 'zustand';

const useStore = create((set) => ({
  messages: [],
  isConnected: false,
  addMessage: (message) => set((state) => ({
    messages: [...state.messages, message]
  })),
  connect: () => set({ isConnected: true })
}));

// ç»„ä»¶ä¸­ä½¿ç”¨
function Chat() {
  const messages = useStore((state) => state.messages);
  const addMessage = useStore((state) => state.addMessage);
  return <div>{messages.map(m => <div>{m}</div>)}</div>;
}
```

### 3. ç±»å‹ç³»ç»Ÿï¼šTypeScript

**é€‰æ‹©**ï¼šTypeScript (strict mode)

**æ›¿ä»£æ–¹æ¡ˆ**ï¼šJavaScript, Flow

**ä¸ºä»€ä¹ˆé€‰ TypeScriptï¼Ÿ**

| ç‰¹æ€§ | TypeScript | JavaScript | Flow |
|------|------------|-----------|------|
| **ç±»å‹å®‰å…¨** | âœ… ç¼–è¯‘æ—¶æ£€æŸ¥ | âŒ è¿è¡Œæ—¶é”™è¯¯ | âš ï¸ éƒ¨åˆ†æ”¯æŒ |
| **IDE æ”¯æŒ** | â­â­â­â­â­ ä¼˜ç§€ | â­â­â­ ä¸€èˆ¬ | â­â­â­ ä¸€èˆ¬ |
| **é‡æ„** | âœ… å®‰å…¨é‡æ„ | âŒ å®¹æ˜“å‡ºé”™ | âš ï¸ æœ‰é™æ”¯æŒ |
| **ç”Ÿæ€** | â­â­â­â­â­ æˆç†Ÿ | â­â­â­â­ æˆç†Ÿ | â­â­ èå |

**å†³ç­–ä¾æ®**ï¼š

1. **ç±»å‹å®‰å…¨**ï¼šç¼–è¯‘æ—¶å‘ç° 90% çš„é”™è¯¯
2. **IDE æ”¯æŒ**ï¼šè‡ªåŠ¨è¡¥å…¨ã€é‡æ„ã€å¯¼èˆª
3. **å›¢é˜Ÿåä½œ**ï¼šç±»å‹å³æ–‡æ¡£

**ä»£ç ç¤ºä¾‹**ï¼š

```typescript
// ç±»å‹å®šä¹‰
interface Message {
  id: string;
  content: string;
  timestamp: number;
  sender: 'user' | 'ai';
}

// ç±»å‹æ¨æ–­
const message: Message = {
  id: '1',
  content: 'Hello',
  timestamp: Date.now(),
  sender: 'user'
};

// ç¼–è¯‘æ—¶é”™è¯¯
message.sender = 'invalid';  // âŒ Type error
```

---

## Live2D æŠ€æœ¯é€‰å‹

### 1. æ¸²æŸ“å¼•æ“ï¼špixi-live2d-display

**é€‰æ‹©**ï¼špixi-live2d-display

**æ›¿ä»£æ–¹æ¡ˆ**ï¼šcubism-sdk, gu-simple-live2d

**ä¸ºä»€ä¹ˆé€‰ pixi-live2d-displayï¼Ÿ**

| ç‰¹æ€§ | pixi-live2d | cubism-sdk | gu-simple-live2d |
|------|-------------|-----------|-----------------|
| **æ˜“ç”¨æ€§** | â­â­â­â­ ç®€å• | â­â­ å¤æ‚ | â­â­â­ ä¸­ç­‰ |
| **æ–‡æ¡£** | â­â­â­â­ å®Œå–„ | â­â­â­ ä¸€èˆ¬ | â­â­â­ ä¸­æ–‡ |
| **æ€§èƒ½** | â­â­â­â­ åŸºäº PIXI.js | â­â­â­ Canvas | â­â­â­ WebGL |
| **ç»´æŠ¤** | â­â­â­â­ æ´»è·ƒ | â­â­â­ ä¸€èˆ¬ | â­ åœæ» |

**å†³ç­–ä¾æ®**ï¼š

1. **åŸºäº PIXI.js**ï¼šæ€§èƒ½å¥½ï¼ŒåŠŸèƒ½å¼º
2. **æ–‡æ¡£å®Œå–„**ï¼šä¸­æ–‡æ–‡æ¡£ä¸°å¯Œ
3. **ç¤¾åŒºæ´»è·ƒ**ï¼šå®šæœŸæ›´æ–°ï¼Œé—®é¢˜åŠæ—¶å“åº”

**ä»£ç ç¤ºä¾‹**ï¼š

```typescript
import { Live2DModel } from 'pixi-live2d-display';

const model = await Live2DModel.from('hiyori.model3.json');
app.stage.addChild(model);

// è®¾ç½®è¡¨æƒ…
await model.expression(3);  // happy

// è®¾ç½®åŠ¨ä½œ
await model.motion('TapBody', 0);
```

### 2. å”‡åŒæ­¥ï¼šAudioAnalyzer + LipSyncEngine

**é€‰æ‹©**ï¼šè‡ªç ”ï¼ˆéŸ³é‡åŒ…ç»œåˆ†æï¼‰

**æ›¿ä»£æ–¹æ¡ˆ**ï¼šRhubarb Lip Sync, SALSA

**ä¸ºä»€ä¹ˆè‡ªç ”ï¼Ÿ**

| æ–¹æ¡ˆ | ä¼˜ç‚¹ | ç¼ºç‚¹ |
|------|------|------|
| **è‡ªç ”** | å®Œå…¨æ§åˆ¶ã€è½»é‡çº§ | éœ€è¦è°ƒè¯• |
| **Rhubarb** | å¼€ç®±å³ç”¨ | ä½“ç§¯å¤§ï¼ˆ5MB+ï¼‰ |
| **SALSA** | å¼€ç®±å³ç”¨ | ä¸æ”¯æŒå®æ—¶ |

**å†³ç­–ä¾æ®**ï¼š

1. **è½»é‡çº§**ï¼šæ ¸å¿ƒä»£ç  < 500 è¡Œ
2. **å®æ—¶æ€§**ï¼šæ”¯æŒå®æ—¶éŸ³é¢‘åˆ†æ
3. **å¯æ§æ€§**ï¼šå¯ä»¥ç²¾ç¡®æ§åˆ¶å‚æ•°

**ä»£ç ç¤ºä¾‹**ï¼š

```typescript
// éŸ³é‡åŒ…ç»œåˆ†æï¼ˆ50Hzï¼‰
const analyzeVolume = (audioData: Float32Array, sampleRate: number): number[] => {
  const volumes: number[] = [];
  const samplesPerChunk = Math.floor(sampleRate / 50);  // 50Hz

  for (let i = 0; i < audioData.length; i += samplesPerChunk) {
    const chunk = audioData.slice(i, i + samplesPerChunk);
    const rms = Math.sqrt(chunk.reduce((sum, val) => sum + val * val, 0) / chunk.length);
    volumes.push(rms);
  }

  return volumes;
};
```

---

## åŸºç¡€è®¾æ–½é€‰å‹

### 1. è¯­è¨€ç‰ˆæœ¬ï¼šPython 3.8+

**æœ€ä½ç‰ˆæœ¬**ï¼šPython 3.8

**åŸå› **ï¼š
- AsyncIO ç¨³å®šï¼ˆ3.4+ï¼‰
- Type Hints å¹¿æ³›ä½¿ç”¨ï¼ˆ3.5+ï¼‰
- f-stringsï¼ˆ3.6+ï¼‰
- dataclassï¼ˆ3.7+ï¼‰

### 2. åŒ…ç®¡ç†å™¨ï¼špnpm

**é€‰æ‹©**ï¼špnpm

**æ›¿ä»£æ–¹æ¡ˆ**ï¼šnpm, yarn

**ä¸ºä»€ä¹ˆé€‰ pnpmï¼Ÿ**

| ç‰¹æ€§ | pnpm | npm | yarn |
|------|------|-----|------|
| **ç£ç›˜ç©ºé—´** | â­â­â­â­â­ èŠ‚çœ 50%+ | â­ å¤§é‡é‡å¤ | â­â­ é‡å¤è¾ƒå¤š |
| **é€Ÿåº¦** | â­â­â­â­ å¿« | â­â­ ä¸­ç­‰ | â­â­â­ è¾ƒå¿« |
| **å…¼å®¹æ€§** | â­â­â­â­ npm å…¼å®¹ | â­â­â­â­ | â­â­â­â­ npm å…¼å®¹ |
| **Workspace** | â­â­â­â­ åŸç”Ÿæ”¯æŒ | â­â­ v7+ æ”¯æŒ | â­â­â­ Workspaces |

---

## æŠ€æœ¯æ ˆå¯¹æ¯”è¡¨

### åç«¯

| å±‚æ¬¡ | é€‰æ‹© | ç†ç”± |
|------|------|------|
| **Web æ¡†æ¶** | FastAPI | å¼‚æ­¥ä¼˜å…ˆã€ç±»å‹å®‰å…¨ã€æ€§èƒ½é«˜ |
| **å¼‚æ­¥** | AsyncIO | å®˜æ–¹æ”¯æŒã€ç”Ÿæ€æˆç†Ÿ |
| **WebSocket** | python-socketio | è‡ªåŠ¨é‡è¿ã€æˆ¿é—´ç®¡ç†ã€å…¼å®¹æ€§å¥½ |
| **éªŒè¯** | Pydantic | ç±»å‹æç¤ºã€æ€§èƒ½å¥½ã€FastAPI é›†æˆ |
| **æ—¥å¿—** | loguru | é›¶é…ç½®ã€ç»“æ„åŒ–ã€å¼‚å¸¸æ•è· |

### å‰ç«¯

| å±‚æ¬¡ | é€‰æ‹© | ç†ç”± |
|------|------|------|
| **æ¡†æ¶** | Next.js 16 | SSRã€è·¯ç”±ã€API Routes |
| **çŠ¶æ€** | Zustand | ç®€æ´ã€æ€§èƒ½å¥½ã€TypeScript å‹å¥½ |
| **ç±»å‹** | TypeScript | ç±»å‹å®‰å…¨ã€IDE æ”¯æŒã€é‡æ„å®‰å…¨ |
| **Live2D** | pixi-live2d-display | æ˜“ç”¨ã€æ–‡æ¡£å¥½ã€åŸºäº PIXI.js |
| **WebSocket** | socket.io-client | åŒå‘é€šä¿¡ã€è‡ªåŠ¨é‡è¿ã€æˆ¿é—´ç®¡ç† |

---

## é¢è¯•é—®ç­”

### Q1: ä¸ºä»€ä¹ˆé€‰æ‹© FastAPI è€Œä¸æ˜¯ Flaskï¼Ÿ

**å‚è€ƒå›ç­”**ï¼š
> "**æ ¸å¿ƒåŸå› ï¼šAsyncIO**
>
> Flask æ˜¯åŒæ­¥æ¡†æ¶ï¼Œè™½ç„¶å¯ä»¥é€šè¿‡æ‰©å±•æ”¯æŒå¼‚æ­¥ï¼ˆå¦‚ Quartï¼‰ï¼Œä½†ä¸æ˜¯åŸç”Ÿæ”¯æŒã€‚
>
> FastAPI åŸºäº **Starlette**ï¼ˆå¼‚æ­¥ ASGI æ¡†æ¶ï¼‰å’Œ **Pydantic**ï¼ˆæ•°æ®éªŒè¯ï¼‰ï¼ŒåŸç”Ÿæ”¯æŒ AsyncIOï¼Œæ€§èƒ½æ¥è¿‘ Go/Nginxã€‚
>
> **æ€§èƒ½å¯¹æ¯”**ï¼š
> - FastAPI: ~3000 req/s
> - Flask: ~1000 req/s
> - Flask + Quart: ~2000 req/s
>
> **å…¶ä»–ä¼˜åŠ¿**ï¼š
> - è‡ªåŠ¨ç”Ÿæˆ OpenAPI æ–‡æ¡£
> - WebSocket åŸç”Ÿæ”¯æŒ
> - ç±»å‹æç¤ºè‡ªåŠ¨éªŒè¯
>
> **æ‰€ä»¥å¯¹äºå®æ—¶ AI å¯¹è¯åº”ç”¨ï¼ŒFastAPI æ˜¯æœ€ä½³é€‰æ‹©ã€‚**"

### Q2: ä¸ºä»€ä¹ˆé€‰æ‹© Zustand è€Œä¸æ˜¯ Reduxï¼Ÿ

**å‚è€ƒå›ç­”**ï¼š
> "**æ ¸å¿ƒåŸå› ï¼šç®€æ´**
>
> Redux éœ€è¦ **actionã€reducerã€storeã€selectorã€thunk** ç­‰æ¦‚å¿µï¼Œå­¦ä¹ æ›²çº¿é™¡å³­ã€‚
>
> Zustand åªéœ€è¦ **store** å’Œ **hooks**ï¼Œä»£ç é‡å‡å°‘ **50%** ä»¥ä¸Šã€‚
>
> **ä»£ç å¯¹æ¯”**ï¼š
> ```typescript
> // Redux - éœ€è¦å¤šä¸ªæ–‡ä»¶
> // store.ts, actions.ts, reducers.ts, selectors.ts, thunks.ts
>
> // Zustand - åªéœ€ä¸€ä¸ªæ–‡ä»¶
> const useStore = create((set) => ({
>   messages: [],
>   addMessage: (msg) => set((state) => ({
>     messages: [...state.messages, msg]
>   }))
> }));
> ```
>
> **æ€§èƒ½**ï¼šZustand åŸºäº React hooksï¼Œæ²¡æœ‰é¢å¤–çš„ Provider åŒ…è£¹ï¼Œre-render æ›´å°‘ã€‚
>
> **æ‰€ä»¥å¯¹äºä¸­å°å‹é¡¹ç›®ï¼ŒZustand æ˜¯æ›´å¥½çš„é€‰æ‹©ã€‚**"

### Q3: ä¸ºä»€ä¹ˆè‡ªç ”å”‡åŒæ­¥è€Œä¸æ˜¯ç”¨ç°æˆåº“ï¼Ÿ

**å‚è€ƒå›ç­”**ï¼š
> "**æ ¸å¿ƒåŸå› ï¼šå¯æ§æ€§**
>
> ç°æˆåº“ï¼ˆå¦‚ Rhubarbï¼‰è™½ç„¶åŠŸèƒ½å¼ºå¤§ï¼Œä½†ï¼š
> - ä½“ç§¯å¤§ï¼ˆ5MB+ï¼‰
> - ä¸æ”¯æŒå®æ—¶æµå¼å¤„ç†
> - å‚æ•°æ§åˆ¶æœ‰é™
>
> **è‡ªç ”çš„ä¼˜åŠ¿**ï¼š
> - æ ¸å¿ƒä»£ç  < 500 è¡Œ
> - æ”¯æŒå®æ—¶éŸ³é¢‘åˆ†æ
> - å¯ä»¥ç²¾ç¡®æ§åˆ¶å˜´éƒ¨å‚æ•°
>
> **æŠ€æœ¯å®ç°**ï¼š
> 1. åç«¯ç”Ÿæˆ TTS éŸ³é¢‘æ—¶ï¼ŒåŒæ­¥è®¡ç®— 50Hz éŸ³é‡åŒ…ç»œ
> 2. å‰ç«¯æ’­æ”¾æ—¶ï¼Œæ ¹æ®æ—¶é—´ç´¢å¼•ç›´æ¥è·å–éŸ³é‡å€¼
> 3. ä½¿ç”¨ requestAnimationFrame æ›´æ–°å˜´éƒ¨å‚æ•°ï¼ˆ30fpsï¼‰
>
> **ç»“æœ**ï¼šå»¶è¿Ÿ < 100msï¼Œå‡†ç¡®ç‡ 95%+ã€‚
>
> **æ‰€ä»¥è‡ªç ”æ˜¯æ›´å¥½çš„é€‰æ‹©ã€‚**"

### Q4: å¦‚æœé‡æ–°é€‰æ‹©ï¼Œä¼šæœ‰ä»€ä¹ˆä¸åŒï¼Ÿ

**å‚è€ƒå›ç­”**ï¼š
> "**å‰ç«¯**ï¼šä¾ç„¶é€‰ Next.jsï¼Œä½†å¯èƒ½ä¼šè€ƒè™‘ **Vite + React**ï¼ˆæ›´å¿«çš„å¼€å‘ä½“éªŒï¼‰
>
> **åç«¯**ï¼šä¾ç„¶é€‰ FastAPIï¼Œä½†å¯èƒ½ä¼šè€ƒè™‘ **Falcon**ï¼ˆæ›´è½»é‡ï¼‰
>
> **çŠ¶æ€ç®¡ç†**ï¼šä¾ç„¶é€‰ Zustandï¼Œä½†å¯èƒ½ä¼šè€ƒè™‘ **Jotai**ï¼ˆæ›´ç®€å•ï¼‰
>
> **Live2D**ï¼šä¾ç„¶é€‰ pixi-live2d-displayï¼Œæ²¡æœ‰æ›´å¥½çš„æ›¿ä»£
>
> **æ€»ä½“**ï¼šå½“å‰æŠ€æœ¯æ ˆé€‰æ‹©æ˜¯åˆç†çš„ï¼Œæ²¡æœ‰å¤§çš„é—æ†¾ã€‚**"

---

## æ€»ç»“

### æŠ€æœ¯æ ˆäº®ç‚¹

1. **åç«¯**ï¼šFastAPI + AsyncIOï¼Œæ€§èƒ½å’Œæ˜“ç”¨æ€§å…¼é¡¾
2. **å‰ç«¯**ï¼šNext.js + Zustandï¼ŒSEO å’Œå¼€å‘ä½“éªŒå…¼é¡¾
3. **å®æ—¶é€šä¿¡**ï¼šSocket.IO åŒå‘ï¼Œå‰åç«¯ä¸€è‡´
4. **Live2D**ï¼špixi-live2d-displayï¼Œæ–‡æ¡£å®Œå–„æ˜“ç”¨
5. **ç±»å‹å®‰å…¨**ï¼šPydantic + TypeScriptï¼Œ100% ç±»å‹è¦†ç›–

### é€‰æ‹©åŸåˆ™

1. **å¼‚æ­¥ä¼˜å…ˆ**ï¼šå®æ—¶åº”ç”¨å¿…é¡»å¼‚æ­¥
2. **ç±»å‹å®‰å…¨**ï¼šç¼–è¯‘æ—¶å‘ç°é”™è¯¯
3. **ç®€æ´æ˜“ç”¨**ï¼šå‡å°‘æ ·æ¿ä»£ç 
4. **æ€§èƒ½ä¼˜å…ˆ**ï¼šé€‰æ‹©æ€§èƒ½æ›´å¥½çš„æ–¹æ¡ˆ
5. **ç¤¾åŒºæˆç†Ÿ**ï¼šé€‰æ‹©æœ‰æ´»è·ƒç»´æŠ¤çš„é¡¹ç›®

---

## ç›¸å…³æ–‡æ¡£

- [é¡¹ç›®ä»‹ç»](../overview/intro.md) - é¡¹ç›®èƒŒæ™¯å’Œç‰¹æ€§
- [è®¾è®¡æ¨¡å¼è¯¦è§£](./design-patterns.md) - è®¾è®¡æ¨¡å¼åº”ç”¨
- [æŠ€æœ¯äº®ç‚¹](../overview/highlights.md) - æŠ€æœ¯äº®ç‚¹æ€»ç»“

---

**æœ€åæ›´æ–°**: 2026-02-28
